<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Membership</title>
    <link rel="stylesheet" href="../css/membership.css">
    <script>
        // 유효성 검사 함수
        function validateField(input) {
            let isValid = true;
            let username = document.getElementById('username');
            let name = document.getElementById('name');
            let email = document.getElementById('email');
            let password = document.getElementById('password');
            let confirmPassword = document.getElementById('confirm-password');
        
            if (input === username) {
                // 아이디 필드 유효성 검사
                let usernamePattern = /^[a-zA-Z][a-zA-Z0-9]{3,}$/; // 영문으로 시작하고, 4자 이상, 영문과 숫자 조합
                if (username.value.trim() === "") {
                    setInvalid(username, "값을 입력해 주세요");
                    isValid = false;
                } else if (username.value.length < 4) {
                    setInvalid(username, "4자 이상 입력해 주세요");
                    isValid = false;
                } else if (!usernamePattern.test(username.value)) {
                    setInvalid(username, "영문으로 시작하는 영문+숫자 조합이어야 합니다.");
                    isValid = false;
                } else {
                    setValid(username);
                }
            }
        
            if (input === name) {
                // 이름 필드 유효성 검사 (빈 값 체크)
                if (name.value.trim() === "") {
                    setInvalid(name, "이름을 입력하세요.");
                    isValid = false;
                } else {
                    setValid(name);
                }
            }
        
            if (input === email) {
                // 이메일 필드 유효성 검사
                let emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
                if (!emailPattern.test(email.value)) {
                    setInvalid(email, "올바른 이메일을 입력하세요.");
                    isValid = false;
                } else {
                    setValid(email);
                }
            }
        
            if (input === password || input === confirmPassword) {
                // 비밀번호 필드 유효성 검사
                let passwordPattern = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[!@#$%^&*]).{8,}$/;
        
                if (password.value.trim() === "") {
                    setInvalid(password, "비밀번호를 입력해 주세요");
                    isValid = false;
                } else if (password.value.length < 8) {
                    setInvalid(password, "8자 이상 입력해 주세요");
                    isValid = false;
                } else if (!/\d/.test(password.value)) {
                    setInvalid(password, "숫자를 반드시 포함해야 합니다.");
                    isValid = false;
                } else if (!/[!@#$%^&*]/.test(password.value)) {
                    setInvalid(password, "특수문자를 반드시 포함해야 합니다.");
                    isValid = false;
                } else if (!/[A-Z]/.test(password.value)) {
                    setInvalid(password, "영문 대문자를 반드시 포함해야 합니다.");
                    isValid = false;
                } else {
                    setValid(password);
                }

                // 비밀번호 확인 필드 유효성 검사
                if (confirmPassword.value !== password.value && confirmPassword.value !== "") {
                    setInvalid(confirmPassword, "비밀번호가 일치하지 않습니다.");
                    isValid = false;
                } else if (confirmPassword.value === "") {
                    setValid(confirmPassword); // 비밀번호 확인 필드가 비어 있을 경우 유효성 검사 하지 않음
                } else {
                    setValid(confirmPassword);
                }
            }
        
            return isValid;
        }

        // 유효성 검사 실패 시 스타일 적용
        function setInvalid(input, message) {
            let parent = input.parentElement;
            let span = parent.querySelector('.span-text');
        
            input.classList.add('invalid');
            input.classList.remove('valid');
            
    
            input.style.border = '2px solid lightcoral';  // 테두리 두께 2px로 설정
            input.style.backgroundColor = '#fdd';  // 배경 색상 변경
        
            span.style.color = 'lightcoral';
            span.textContent = message;
            span.style.display = 'block';  // 오류 메시지 계속 표시
        }
        
        function setValid(input) {
            let parent = input.parentElement;
            let span = parent.querySelector('.span-text');
        
            input.classList.add('valid');
            input.classList.remove('invalid');
        
            // 기본 스타일로 되돌리기
            input.style.border = '';  // 기본 테두리로 되돌림
            input.style.backgroundColor = '';  // 기본 배경 색상으로 되돌림
        
            span.style.color = '';  // 기본 텍스트 색상으로 되돌림
            span.textContent = '';  // 오류 메시지 제거
            span.style.display = 'none';  // 오류 메시지 숨김
        }

        // 폼 제출 시 로그인 페이지로 이동
        function validateForm() {
            let isFormValid = true;
            let fields = document.querySelectorAll('input');
            fields.forEach(field => {
                if (!validateField(field)) {
                    isFormValid = false;
                }
            });

            if (isFormValid) {
                window.location.href = "login.html"; // 성공적으로 유효성 검사 통과 시 login.html로 이동
            }

            return false; // 폼 제출을 막고 자바스크립트로 이동 처리
        }

        // 이전 페이지로 돌아가기
        function goBack() {
            window.history.back(); // 이전 페이지로 이동
        }
    </script>
</head>

<body>

    <div class="container">
        <div class="logo">
            <img src="..\img\logo.png" alt="Logo" />
            <div class="tagline">회원가입 후 다양한 서비스를 즐겨보세요.</div>
        </div>
    
        <form id="signup-form" onsubmit="return validateForm()">
            <div class="form-group">
                <input type="text" id="username" name="username" placeholder="" oninput="validateField(this)">
                <label for="username">아이디</label>
                <span class="span-text">영문으로 시작하는 4~24자의 영문+숫자로 입력해주세요.</span>
            </div>
            <div class="form-group">
                <input type="text" id="name" name="name" placeholder="" oninput="validateField(this)">
                <label for="name">이름</label>
                <span class="span-text">이름을 입력하세요.</span>
            </div>
            <div class="form-group">
                <input type="email" id="email" name="email" placeholder="" oninput="validateField(this)">
                <label for="email">이메일</label>
                <span class="span-text">이메일을 입력하세요.</span>
            </div>
            <div class="form-group">
                <input type="password" id="password" name="password" placeholder="" oninput="validateField(this)">
                <label for="password">비밀번호</label>
                <span class="span-text">8자리 이상의 영문, 숫자, 특수문자 조합을 입력하세요.</span>
            </div>
            <div class="form-group">
                <input type="password" id="confirm-password" name="confirm-password" placeholder="" oninput="validateField(this)">
                <label for="confirm-password">비밀번호 확인</label>
                <span class="span-text">비밀번호를 다시 입력하세요.</span>
            </div>
            <div class="form-actions">
                <button type="button" class="prev-btn" onclick="goBack()">이전</button>
                <button type="submit" class="next-btn">회원가입</button>
            </div>
        </form>
    </div>
</body>

</html>
